import{u as Q,b as p,c as w,o as v,w as n,f as y,a as s,Q as C,e as k,g as U,i as f,h as g,j as d,k as q,n as S,t as b,ah as h,l as P}from"./index-lAEU-3ZN.js";import{Q as B}from"./QLinearProgress-BjU2gNSe.js";import{Q as I}from"./QForm-DsYz_fxS.js";import{Q as N}from"./QPage-eCB9bOON.js";import{u as E}from"./use-quasar-DlnkSLdv.js";import{v as F,g as $}from"./validators-DMKJKxBu.js";const z={key:2,class:"text-negative text-caption"},G={__name:"ProfilePage",setup(D){const m=E(),r=Q(),e=p({id:r.user?.id||"",username:r.user?.username||"",email:r.user?.email||"",password:"",confirmPassword:""}),o=p(null),i=p(!0),t=p({label:"",color:"grey",value:0}),c=()=>{e.value={id:r.user?.id||"",username:r.user?.username||"",email:r.user?.email||"",password:"",confirmPassword:""},o.value=null,t.value={label:"",color:"grey",value:0}},V=()=>{t.value=$(e.value.password)},x=async()=>{if(o.value=null,e.value.password){if(e.value.password!==e.value.confirmPassword){o.value="Passwords do not match",m.notify({type:"negative",message:o.value,timeout:3e3});return}if(!F(e.value.password)){o.value="Password must include uppercase, lowercase, number, and special character",m.notify({type:"negative",message:o.value,timeout:3e3});return}}try{const u={};e.value.username!==r.user.username&&(u.username=e.value.username),e.value.email!==r.user.email&&(u.email=e.value.email),e.value.password&&(u.password=e.value.password),await r.updateProfile(u),m.notify({type:"positive",message:"Profile updated successfully!"}),c()}catch(u){m.notify({type:"negative",message:u.response?.data?.message||"Failed to update profile"})}};return(u,a)=>(v(),w(N,{class:"q-pa-md"},{default:n(()=>[a[7]||(a[7]=y("div",{class:"text-h5 q-mb-md"},"My Profile",-1)),s(C,{flat:"",bordered:"",class:"q-pa-md",style:{"max-width":"600px",margin:"auto"}},{default:n(()=>[s(k,null,{default:n(()=>[...a[6]||(a[6]=[y("div",{class:"text-h6"},"Profile Information",-1)])]),_:1}),s(I,{class:"q-gutter-md",onSubmit:U(x,["prevent"])},{default:n(()=>[s(d,{modelValue:e.value.id,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.id=l),label:"User ID",outlined:"",dense:"",readonly:""},null,8,["modelValue"]),s(d,{modelValue:e.value.username,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.username=l),label:"Username",outlined:"",dense:"",rules:[l=>!!l||"Username is required"]},null,8,["modelValue","rules"]),s(d,{modelValue:e.value.email,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.email=l),label:"Email",type:"email",outlined:"",dense:"",rules:[l=>!!l||"Email is required"]},null,8,["modelValue","rules"]),s(d,{modelValue:e.value.password,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.password=l),label:"New Password",type:i.value?"password":"text",outlined:"",dense:"",hint:"Leave empty if you donâ€™t want to change",onInput:V},{append:n(()=>[s(q,{name:i.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:a[3]||(a[3]=l=>i.value=!i.value)},null,8,["name"])]),_:1},8,["modelValue","type"]),t.value.label?(v(),w(B,{key:0,value:t.value.value,color:t.value.color,size:"10px",class:"rounded-borders q-mt-xs"},null,8,["value","color"])):f("",!0),t.value.label?(v(),g("div",{key:1,class:S(["text-caption text-center",`text-${t.value.color}`])},b(t.value.label),3)):f("",!0),s(d,{modelValue:e.value.confirmPassword,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.confirmPassword=l),label:"Confirm New Password",type:i.value?"password":"text",outlined:"",dense:"",disable:!e.value.password,hint:"Re-enter new password"},null,8,["modelValue","type","disable"]),o.value?(v(),g("div",z,b(o.value),1)):f("",!0),s(h,{align:"right"},{default:n(()=>[s(P,{flat:"",label:"Cancel",color:"grey",onClick:c}),s(P,{color:"primary",type:"submit",label:"Save Changes"})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{G as default};
